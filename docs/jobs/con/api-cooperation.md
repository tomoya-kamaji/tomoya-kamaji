---
layout: default

title: 医療向け電子同意書と電子カルテをつなぐ連携 API のセキュリティ設計と実装
---

[← プロフィールに戻る](../../index.md)

### 概要

- 自社サービスの医療向け電子同意書と電子カルテをつなぐ連携 API のセキュリティ設計と実装をリード。API キー＋ mTLS の多層認証、エンドポイント整流化、監査性向上を一気通貫で推進

### 背景

- なぜこの実装が必要だったか
  - 自社として電子カルテ連携の実運用実績がなく、セキュリティ要件の高い医療機関に導入障壁があった
  - 初号事例を成功させ、以降の導入で再利用できる標準と手順を確立するため

### 役割・体制

- セキュリティ設計〜実装〜検証〜運用フロー整備までを単独主導
- 認証局選定や証明書発行プロセスでベンダーと折衝、仕様合意をドライブ

### 発揮したバリュー

- 認証キー／証明書の発行局を比較・選定し、ベンダーとメールで要件定義と証明書属性の整合を獲得
- クライアント証明書のアプリ層検証を実装（PEM 検証、CA チェーン検証、Subject O 属性による組織名チェック、失効確認の設計）
- エンドポイント命名・責務の見直しで誤用リスクを低減（例：/partner/v1/consents/link への整理）

（前提と制約）

- Google Cloud 構成（外部 HTTP(S)ロードバランサ＋ Cloud Run ）では、クライアントとの TLS ハンドシェイク時に相互認証（mTLS）を実現する運用要件を満たせなかったため、mTLS は不採用
- 代替として、アプリケーション層でのクライアント証明書検証と API キーの多層防御でセキュリティ基準を満たす方針に転換

### 技術的な取り組み（実装ハイライト）

- API キー必須化とヘッダ検証（キーのローテーション前提での設計）
- クライアント証明書のアプリ層検証を実装（PEM 検証、CA チェーン検証、Subject O 属性による組織名チェック、失効確認の設計）
- 例外ハンドリング標準化と監査ログの粒度設計（検証失敗理由を分類して記録）

### 成果・インパクト

- 本番運用で 1 年間インシデント 0
- 鹿児島の医療機関で初号連携を現地立会いで成功、現場から「業務が効率化した」と評価を獲得
- 以降の医療機関向け連携の標準手順・実装テンプレートとして再利用可能に

### 使用技術・ツール

- Node.js（Express）、node-forge pki、OpenSSL（OCSP）、Google Cloud（LB／API サーバ）
- 証明書運用：ルート CA 配備、クライアント証明書の属性検証、鍵・証明書ローテーション前提の設計

[← プロフィールに戻る](../../index.md)
